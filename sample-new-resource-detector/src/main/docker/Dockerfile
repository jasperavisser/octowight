FROM oracle-java8

RUN useradd -ms /bin/bash app
USER app

ADD app /opt/app
WORKDIR /opt/app

ENV OCTOWIGHT_KAFKA_HOSTNAME kafka-broker
ENV OCTOWIGHT_KAFKA_CONSUMER_TIMEOUT_MS 200
ENV OCTOWIGHT_KAFKA_TOPIC_EVENTS row-change-events
ENV OCTOWIGHT_KAFKA_TOPIC_RESOURCES_DIRTY dirty-resources
ENV OCTOWIGHT_POSTGRES_HOSTNAME postgres
ENV OCTOWIGHT_POSTGRES_PORT 5432
ENV OCTOWIGHT_POSTGRES_USERNAME postgres
ENV OCTOWIGHT_POSTGRES_DATABASE postgres
ENV OCTOWIGHT_ZOOKEEPER_HOSTNAME zookeeper

ENTRYPOINT ["java", "-cp", "/opt/app/*", "nl.haploid.octowight.App"]
