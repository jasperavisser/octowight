FROM oracle-java8

RUN useradd -ms /bin/bash app
USER app

ADD *.jar /opt/app/
WORKDIR /opt/app/

ENV OCTOWIGHT_KAFKA_HOSTNAME=kafka-broker \
	OCTOWIGHT_KAFKA_PORT=9092 \
	OCTOWIGHT_KAFKA_BATCH_SIZE=200 \
	OCTOWIGHT_KAFKA_CONSUMER_TIMEOUT_MS=200 \
	OCTOWIGHT_KAFKA_GROUP_ID=resource-builder \
	OCTOWIGHT_KAFKA_TOPIC_EVENTS=row-change-events \
	OCTOWIGHT_KAFKA_LIMIT_RESOURCES_DIRTY=10 \
	OCTOWIGHT_KAFKA_TOPIC_RESOURCES_DIRTY=dirty-resources \
	OCTOWIGHT_KAFKA_TOPIC_RESOURCES_BUILT=built-resources \
	OCTOWIGHT_POSTGRES_HOSTNAME=postgres-data-repository \
	OCTOWIGHT_POSTGRES_PORT=5432 \
	OCTOWIGHT_POSTGRES_USERNAME=postgres \
	OCTOWIGHT_POSTGRES_DATABASE=postgres \
	OCTOWIGHT_REGISTRY_MONGO_HOSTNAME=mongo-resource-registry \
	OCTOWIGHT_REGISTRY_MONGO_PORT=27017 \
	OCTOWIGHT_REGISTRY_MONGO_DATABASE=resource-registry \
	OCTOWIGHT_ZOOKEEPER_HOSTNAME=zookeeper \
	OCTOWIGHT_ZOOKEEPER_PORT=2181

CMD ["java", "-jar", "sample-resource-builder-1.0-SNAPSHOT.jar"]
