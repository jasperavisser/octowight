FROM oracle-java8

RUN useradd -ms /bin/bash app
USER app

ADD app /opt/app
WORKDIR /opt/app

ENV OCTOWIGHT_KAFKA_HOSTNAME kafka-broker
ENV OCTOWIGHT_KAFKA_PORT 9092
ENV OCTOWIGHT_KAFKA_BATCH_SIZE 200
ENV OCTOWIGHT_KAFKA_CONSUMER_TIMEOUT_MS 200
ENV OCTOWIGHT_KAFKA_GROUP_ID dirty-resource-detector
ENV OCTOWIGHT_KAFKA_TOPIC_EVENTS row-change-events
ENV OCTOWIGHT_KAFKA_TOPIC_RESOURCES_DIRTY dirty-resources
ENV OCTOWIGHT_REGISTRY_POSTGRES_HOSTNAME postgres-resource-registry
ENV OCTOWIGHT_REGISTRY_POSTGRES_PORT 5432
ENV OCTOWIGHT_REGISTRY_POSTGRES_USERNAME postgres
ENV OCTOWIGHT_REGISTRY_POSTGRES_DATABASE postgres
ENV OCTOWIGHT_ZOOKEEPER_HOSTNAME zookeeper
ENV OCTOWIGHT_ZOOKEEPER_PORT 2181

ENTRYPOINT ["java", "-cp", "/opt/app/*", "nl.haploid.octowight.App"]
